<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Lightning Out App</title>
    <script src="https://developer-dev-ed.my.salesforce.com/lightning/lightning.out.latest.js"></script>
  </head>
  <body>

    <div id="lightning"></div>

    <script>
      // Get access token from URL hash
      const token = new URLSearchParams(location.hash.slice(1)).get("access_token");

      if (!token) {
        // Redirect to Salesforce OAuth implicit flow
        const clientId = "3MVG9r4iINOFQpJwWJXf2bICtpasys0cVGILWGMa8l45XRnVL_MxQfWYZn0TPo2KEmAv3AU6hQvQRpgbu57rZ"; // Replace with your Connected App Consumer Key
        const redirectUri = encodeURIComponent("https://it-oyj.github.io/super-simple-app/");
        const loginUrl = `https://login.salesforce.com/services/oauth2/authorize?response_type=token&client_id=${clientId}&redirect_uri=${redirectUri}`;
        location.href = loginUrl;
      } else {
        // Initialize Lightning Out
        $Lightning.use(
          "c:LightningOutApp", // Your Lightning Out app name in Salesforce
          function() {
            $Lightning.createComponent(
              "c:helloWorld",
              {},
              "lightning",
              function(cmp) {
                console.log("Component loaded!", cmp);
              }
            );
          },
          "https://developer-dev-ed.my.salesforce.com",
          token
        );
      }
    </script>

  </body>
</html>
